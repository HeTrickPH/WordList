<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
	<title>Calculator</title>
	<link href="style.css" rel="stylesheet" type="text/css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script>
	// JavaScript start
		function calNumber(numb) {
			var txt = document.getElementById("input").value ;
			document.getElementById("input").value = txt + numb ;
		}
		function calOperator(calF) {
			document.getElementById("input").value += calF ;
		}
		function inputClear() {
			var str = document.getElementById("input").value;
   			document.getElementById("input").value = "";
        }
        function calDel() {
		    var txt = document.getElementById("input").value;
			var txtLen = txt.length;
			var newStr = txt.substring(0,txtLen-1);
		   	document.getElementById("input").value = newStr;
        }
		function calSquareRoot() {
			var result;
			var txt = document.getElementById("input").value;
			result = Math.sqrt(parseFloat(txt));
			document.getElementById("input").value = result
		}
		function calFraction() {
			var result;
			var txt = document.getElementById("input").value;
			result = 1 / parseFloat(txt);
			document.getElementById("input").value = result;
		}
		function calIntChange() {
			var result;
			var val = document.getElementById("input").value;
			if((parseFloat(val)) > 0) {
				result = Math.abs(parseFloat(val)) * -1;
			} else if ((parseFloat(val)) < 0) {
				result = Math.abs(parseFloat(val));
			}
			document.getElementById("input").value = result;
		}
	//Equal
		function calEqual() {
			
			var input = document.getElementById("input").value; 
			var result;
			var idx;
			var num = [];
			var sign = 1;
			// Step 0 - check if negative number at beginning
			
			debugger;
			if (input[0] == "-") {
				sign = -1;
				input = input.substr(1, input.length-1);
			}
			else {
				sign = 1;
			}
			
			
			// Step 1 - Figure out operation
			if ((idx = input.indexOf("+")) >0) { 
			    num = input.split("+");
				result = (parseFloat(num[0]) * sign) + parseFloat(num[1]);				
			} 
			else if ((idx = input.indexOf("-")) >0) {
				num = input.split("-");
				result = (parseFloat(num[0]) * sign) - parseFloat(num[1]);				
			} 
			else if ((idx = input.indexOf("*")) >0) {
				num = input.split("*");
				result = (parseFloat(num[0])*sign) * parseFloat(num[1]);
			}
			else if ((idx = input.indexOf("/")) >0) {
				num = input.split("/");
				result = (parseFloat(num[0]) * sign) / parseFloat(num[1]);				
			} 
			else if ((idx = input.indexOf("^")) >0) {
				num = input.split("^");
				result = Math.pow((parseFloat(num[0]) * sign), parseFloat(num[1]));
			}			
			document.getElementById("input").value = result;
		}
	//memory
		function memorySave() {
			var txt = document.getElementById("input").value;
            if (txt=="" || txt.length==0)
            	return;
            localStorage.setItem("memory", txt);
            console.log("txt=" + txt);
            $("#input").val("");
		}
		function memoryReturn() {
			var memo = localStorage.getItem("memory");
			document.getElementById("input").value = memo;
		}
		function memoryAdd() {
			var memo = localStorage.getItem("memory");
			var input = document.getElementById("input").value;
			console.log("memory"+memo);
			localStorage.memory = parseFloat(memo) + parseFloat(input);
		}
		function memorySubtract() {
			var memo = localStorage.getItem("memory");
			var input = document.getElementById("input").value;
			console.log("memory"+memo);
			localStorage.memory = parseFloat(memo) - parseFloat(input);
		}
		function memoryClear() {
			localStorage.removeItem("memory");
		}
	</script>
</head>
<body>
	<div id="calculator" class="main">
		<div id="maincalc" style="float:left">
			<div id="display">
				<input readonly id="extra" />
				<input id="input"/>
			</div>
			<div id="Ms">
				<button onclick="memoryClear()" class="memory">MC</button>
				<button onclick="memoryReturn()" class="memory">MR</button>
				<button onclick="memorySave()" class="memory">MS</button>
				<button onclick="memoryAdd()" class="memory">M+</button>
				<button onclick="memorySubtract()" class="memory">M-</button>
			</div>
			<table id="btns">
				<tr id="tr1">
					<td><button value="%" onclick="" class="special"><span>%</span></button></td>
					<td><button value="√" onclick="calSquareRoot()" class="special"><span>√</span></button></td>
					<td><button value="^" onclick="calOperator(this.value)" class="special"><span>^</span></button></td>
					<td><button onclick="calFraction()" class="special"><span>1/x</span></button></td>
				</tr>
				<tr>
					<td><button onclick="" class="erager"><span>CE</span></button></td>
					<td><button onclick="inputClear()" class="erager"><span>C</span></button></td>
					<td><button onclick="calDel(this.value)" class="erager"><span>Del</span></button></td>
					<td><button value="/" onclick="calOperator(this.value)" class="symbols"><span>/</span></button></td>
				</tr>
				<tr>
					<td><button value="1" onclick="calNumber(this.value)" class="number"><span>1</span></button></td>
					<td><button value="2" onclick="calNumber(this.value)" class="number"><span>2</span></button></td>
					<td><button value="3" onclick="calNumber(this.value)" class="number"><span>3</span></button></td>
					<td><button value="*" onclick="calOperator(this.value)" class="symbols"><span>*</span></button></td>
				</tr>
				<tr>
					<td><button value="4" onclick="calNumber(this.value)" class="number"><span>4</span></button></td>
					<td><button value="5" onclick="calNumber(this.value)" class="number"><span>5</span></button></td>
					<td><button value="6" onclick="calNumber(this.value)" class="number"><span>6</span></button></td>
					<td><button value="-" onclick="calOperator(this.value)" class="symbols"><span>-</span></button></td>
				</tr>
				<tr>
					<td><button value="7" onclick="calNumber(this.value)" class="number"><span>7</span></button></td>
					<td><button value="8" onclick="calNumber(this.value)" class="number"><span>8</span></button></td>
					<td><button value="9" onclick="calNumber(this.value)" class="number"><span>9</span></button></td>
					<td><button value="+" onclick="calOperator(this.value)" class="symbols"><span>+</span></button></td>
				</tr>
				<tr>
					<td><button onclick="calIntChange()" class="special"><span>+/-</span></button></td>
					<td><button value="0" onclick="calNumber(this.value)" class="number"><span>0</span></button></td>
					<td><button value="." onclick="calNumber(this.value)" class="number"><span>.</span></button></td>
					<td><button value="=" onclick="calEqual()" class="symbols"><span>=</span></button></td>
				</tr>
			</table>
			
		</div>
		<div id="calchistory" style="float:right; overflow:hidden;" >
		  <div style="background-color:white; height:100%; " >
				<p id="historytext">Test</p>
		  </div>
	  </div>
	</div>
</body>
</html>